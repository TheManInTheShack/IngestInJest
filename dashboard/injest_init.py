# ==================================================================================================
# Imports
# ==================================================================================================
import sys
import os
import json
from injest_lib import get_marked_data

# ==================================================================================================
# Initialize
# ==================================================================================================
# ------------------------------------------------------------------------------
# Start
# ------------------------------------------------------------------------------
print("-"*80)
print("Starting...")
print("-"*80)

# ------------------------------------------------------------------------------
# Put together the blocks of text and image assets used in all sheets
# ------------------------------------------------------------------------------
title = "Ingest InJest: An approach to analysis of D.F.Wallace's 'Infinite Jest'"

footnote = {}
footnote['credits'] = "Application by Grant Dickerson, with Ava Barrett and Michael Carter. Original elements copyright 2023."
footnote['revnum']  = "Rev.0"

# ==================================================================================================
# Store default style components
# ==================================================================================================
# ------------------------------------------------------------------------------
# Default
# ------------------------------------------------------------------------------
style_default = {}
style_default['backgroundColor']  = '#111111'
style_default['color']            = '#FFFFFF'
style_default['textAlign']        = 'center'

# ==================================================================================================
# Pull in the main data source shared by all pages
# ==================================================================================================
# ------------------------------------------------------------------------------
# Read the data file
# ------------------------------------------------------------------------------
print("...reading data...")
#data_fname = os.path.join("data","cholt_data.xlsx")
data = get_marked_data(data_fname)

# ------------------------------------------------------------------------------
# Get universal metrics
# ------------------------------------------------------------------------------
metrics = {}

# ------------------------------------------------------------------------------
# Hold the initialized data so we can pass it to the pages
# ------------------------------------------------------------------------------
init_dict = {}
init_dict['title']             = title
init_dict['footnote']          = footnote
init_dict['style_default']     = style_default
init_dict['data']              = data
init_dict['global_metrics']    = global_metrics

# ------------------------------------------------------------------------------
# User info
# ------------------------------------------------------------------------------

